syntax = "proto3";

package com.wibusystem.grpc.auth;

service AuthService {
  rpc validateToken(ValidateTokenRequest) returns (ValidateTokenResponse);
}

message ValidateTokenRequest {
  string token = 1;
  string device_id = 2;
  string session_id = 3;
  string ip_address = 4;
}

message ValidateTokenResponse {
  int32 status = 1;
  string status_code = 2;
  string message = 3;
  TokenData data = 4;
  optional ErrorData error = 5;
  string metadata = 6;
  string timestamp = 7;
  string request_id = 8;

  message TokenData {
    int32 id = 1;
    repeated string roles = 2;
    repeated string permissions = 3;
    bool verified_email = 4;
    bool verified_phone = 5;
    string device_id = 6;
    string session_id = 7;
  }
}

message ErrorData {
  string code = 1;
  string message = 2;
}